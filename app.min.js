var dt,cols=[];let sheeturl="https://spreadsheets.google.com/feeds/list/1apbJy54knVUXcKpuerSrgkADdZaGJ05Xh3pqkhHZZsI/omakdo1/public/values?alt=json";function getSheet(){fetch(sheeturl).then(res=>res.json()).then(json=>getData(json)).then(data=>showInfo(data)).catch(err=>{throw err})}function getData(json){var data=[];return json.feed.entry.forEach(entry=>{var row={};for(const[key,value]of Object.entries(entry))0==key.indexOf("gsx")&&(row[key]=value.$t);data.push(row)}),data}var hasComfirmed={};function showInfo(data){var d="vi"==lang.Code?data[0]["gsx$cậpnhật"]:getJaDate(data[0]["gsx$cậpnhật"].substring(0,10))+data[0]["gsx$cậpnhật"].substring(10);document.getElementById("updatetime").innerText!=d&&(dt=data,document.getElementById("updatetime").innerText=d,drawTable(),document.getElementById("map").innerHTML="",setMap(),google.charts.setOnLoadCallback(drawGraph))}function drawGraph(){var data=new google.visualization.DataTable;for(data.addColumn("string",lang["Ngày"]),data.addColumn("number",lang["Nhiễm"]),data.addColumn({type:"number",role:"annotation"}),data.addColumn("number",lang["Chết"]),data.addColumn({type:"number",role:"annotation"}),data.addColumn("number",lang["Khỏi"]),data.addColumn("number",lang["Mới"]),i=0;i<dt.length;i++){var nn=parseInt(dt[i].gsx$confirmed),tv=parseInt(dt[i].gsx$deaths),kb=parseInt(dt[i].gsx$recovered),d="vi"==lang.Code?dt[i].gsx$date:getJaDate(dt[i].gsx$date);""!=d&&data.addRows([[d,nn,nn,tv,tv,kb,parseInt(dt[i].gsx$newcases)]])}var options={hAxis:{title:null,textStyle:{color:"#01579b",fontSize:11,fontName:"Arial"},titleTextStyle:{color:"#01579b",fontSize:11,fontName:"Arial",bold:!1,italic:!0},slantedTextAngle:90},vAxis:{title:lang["Người"],textStyle:{color:"#1a237e",fontSize:12,bold:!1},titleTextStyle:{color:"#1a237e",fontSize:11,bold:!1,italic:!1},format:"short"},height:600,annotations:{0:{style:"point"}},chartArea:{left:50,top:10,width:"100%",height:"85%"},colors:["#4285f4","#ea4335","#38761d","#4374e0"],legend:{position:"bottom"},series:{0:{pointSize:6,pointShape:"square"},1:{pointSize:6,pointShape:"diamond"},2:{pointSize:4,pointShape:"circle"},3:{lineDashStyle:[1,1]}},focusTarget:"category"},chart=new google.visualization.LineChart(document.getElementById("chart_div"));google.visualization.events.addListener(chart,"ready",(function(){document.getElementById("imageChart").setAttribute("href",chart.getImageURI()),document.getElementById("imageChart").setAttribute("download",`ncov${document.getElementById("updatetime").innerText}.png`)})),chart.draw(data,options);for(var t=document.getElementsByClassName("toggle"),i=0;i<t.length;i++)t[i].onclick=function(e){toggle(this)},cols.length<4?cols[t[i].getAttribute("col")]=!0:0!=cols[t[i].getAttribute("col")]&&0!=cols[t[i].getAttribute("col")+1]||refreshChart();function toggle(el){var col=parseInt(el.getAttribute("col"));view=new google.visualization.DataView(data),1==cols[col]?(el.innerText=el.innerText.replace(lang["Ẩn"],lang["Hiện"]),cols[col]=!1):(el.innerText=el.innerText.replace(lang["Hiện"],lang["Ẩn"]),cols[col]=!0),refreshChart()}function refreshChart(){var setCols=[0,1,3,5,6];cols.forEach((function(c,i){1==c&&setCols.push(i)})),view=new google.visualization.DataView(data),view.setColumns(setCols.sort()),chart.draw(view,options)}}async function drawTable(){var html="",htmlCountries="",htmlProvinces="",news="",lastData;hasComfirmed={};for(var ri=0,i=dt.length-1;i>=0;i--){var d="vi"==lang.Code?dt[i].gsx$date:getJaDate(dt[i].gsx$date);if(""!=d&&(lastData||(lastData=dt[i]),html+="<tr><td>"+d+"</td><td>"+dt[i].gsx$confirmed+" ("+dt[i].gsx$vnconfirmed+")</td><td>"+dt[i].gsx$deaths+" ("+dt[i].gsx$vndeaths+")</td><td>"+dt[i].gsx$recovered+" ("+dt[i].gsx$vnrecovered+")</td><td>"+dt[i].gsx$newcases+"</td></tr>"),htmlCountries+="<tr><td>"+dt[ri].gsx$country+"</td><td>"+dt[ri].gsx$totalcases+"</td><td>",htmlCountries+=dt[ri].gsx$totalnewcases+"</td><td>"+dt[ri].gsx$totaldeaths+"</td><td>",htmlCountries+=dt[ri].gsx$totalnewdeaths+"</td><td>"+dt[ri].gsx$totalrecovered+"</td><td>"+dt[ri].gsx$totalcritical+"</td></tr>",ri++,""!=dt[i]["gsx$tỉnhthành"]){var obj={n:dt[i]["gsx$canhiễm"],c:dt[i]["gsx$cachết"],k:dt[i]["gsx$cakhỏi"],opacity:parseInt(dt[i]["gsx$canhiễm"])/parseInt(lastData.gsx$vnconfirmed)*255};hasComfirmed[dt[i]["gsx$tỉnhthành"]]=obj,htmlProvinces="<tr><td>"+dt[i]["gsx$tỉnhthành"]+"</td><td>"+dt[i]["gsx$canhiễm"]+"</td><td>"+dt[i]["gsx$cachết"]+"</td><td>"+dt[i]["gsx$cakhỏi"]+"</td><td></tr>"+htmlProvinces}i>1&&""!=dt[i][lang["gsx$cậpnhật"]]&&(news+='<li class="tl-item"><div class="timestamp">'+d+'</div><div class="item-title">'+dt[i][lang["gsx$cậpnhật"]].replace(/\[(.*)\]\((https?:\/\/(?:(?!\().)*?)\)/g,'<a href="$2" target="_blank">$1</a>').replace(/\*\*(.*?)\*\*/g,"<strong>$1</strong>").replace(/\*(.*?)\*/g,"<em>$1</em>").replace(/\~(.*?)\~/g,'<span style="font-weight:bold;color:#ea4335;">$1</span>').replace(/\n/g,"<br>")+"</div></li>")}document.getElementById("world").innerHTML=html,document.getElementById("totalcountries").innerHTML=htmlCountries,document.getElementById("totalprovinces").innerHTML=htmlProvinces,document.getElementById("timeline").innerHTML=news,document.getElementById("countries").innerText=dt[0].gsx$update;var activecases=lastData.gsx$confirmed-lastData.gsx$deaths-lastData.gsx$recovered;document.getElementById("activecases").innerHTML='<div class="row"><h3><strong>'+activecases+"</strong><small> "+lang["người"]+'</small></h3></div><div class="row"><div class="one-half column">'+lang["Nhẹ"]+'<h4 style="color:#8080FF;margin-top:0">'+(activecases-lastData.gsx$critical)+'</h4></div> <div class="one-half column">'+lang["Nghiêm trọng"]+'<h4 style="color:#ea4335;margin-top:0">'+lastData.gsx$critical+"</h4></div></div>",document.getElementById("vn-stats").innerHTML='<div class="one-third column">'+lang["Nhiễm"]+"<h4>"+lastData.gsx$vnconfirmed+'</h4></div><div class="one-third column vn-tv">'+lang["Tử vong"]+"<h4>"+lastData.gsx$vndeaths+'</h4></div> <div class="one-third column vn-bp">'+lang["Bình phục"]+"<h4>"+lastData.gsx$vnrecovered+"</h4></div>"}document.addEventListener("DOMContentLoaded",getSheet()),google.charts.load("current",{packages:["corechart","line"]}),setInterval(getSheet,6e4);const url="https://news.google.com/atom/search?q=corona%20"+lang.feed,textarea=document.getElementById("feed");function getFeed(){feednami.load(url).then(feed=>{html="";for(var entries=feed.entries.sort((function(a,b){return new Date(b.date)-new Date(a.date)})),cnt=0,i=0;i<entries.length&&!(cnt>10);i++){cnt++;var entry=entries[i];if(entry.date&&!(entry.description.indexOf("<li>")>=0)){var day=timeago(new Date(entry.date));html+=`<li>${entry.description} <time class="timeago" data="${entry.date}">${day}</time></li>`}}document.getElementById("feed").innerHTML=html,setInterval(updateFeedTime,6e4)})}function updateFeedTime(){for(var x=document.getElementsByClassName("timeago"),i=0;i<x.length;i++)x[i].innerText=timeago(new Date(x[i].getAttribute("data")))}function fbShare(){var winTop=screen.height/2-260,winLeft=screen.width/2-175;return window.open("https://www.facebook.com/sharer/sharer.php?u=https://covid19.ga/","sharer","top="+winTop+",left="+winLeft+",toolbar=0,status=0,width=520,height=350"),!1}function setCookie(cname,cvalue,exdays){var d=new Date;d.setTime(d.getTime()+24*exdays*60*60*1e3);var expires="expires="+d.toUTCString();document.cookie=cname+"="+cvalue+";"+expires+";path=/"}function getCookie(cname){for(var name=cname+"=",ca=document.cookie.split(";"),i=0;i<ca.length;i++){for(var c=ca[i];" "==c.charAt(0);)c=c.substring(1);if(0==c.indexOf(name))return c.substring(name.length,c.length)}return""}getFeed();var _0xa2d2=["div","createElement","textAlign","style","center","RGVzaWduZWQgYnkgbmh0QGh1dXRoYW5oZHRkLmNvbS4gRGF0YTogQuG7mSBZIFThur8sIFdvcmxkT01ldGVycw==","atob","createTextNode","appendChild","body"],x=document[_0xa2d2[1]](_0xa2d2[0]);function getJaDate(date){return date.split("/").reverse().join("/")}function timeago(date){var seconds=Math.floor((new Date-date)/1e3),interval=Math.floor(seconds/31536e3);return interval>1?interval+lang["năm"]:(interval=Math.floor(seconds/2592e3))>1?interval+lang["tháng"]:(interval=Math.floor(seconds/86400))>1?interval+lang["ngày"]:(interval=Math.floor(seconds/3600))>1?interval+lang["giờ"]:(interval=Math.floor(seconds/60))>1?interval+lang["phút"]:lang["giây"]}x[_0xa2d2[3]][_0xa2d2[2]]=_0xa2d2[4],x[_0xa2d2[8]](document[_0xa2d2[7]](decodeURIComponent(escape(window[_0xa2d2[6]](_0xa2d2[5]))))),document[_0xa2d2[9]][_0xa2d2[8]](x);